{"changed":true,"filter":false,"title":"functions.php","tooltip":"/functions.php","value":"<?php\n\n// AUTOMATICALLY ADD FEATURED IMAGE\nfunction autoset_featured() {\n          global $post;\n          $already_has_thumb = has_post_thumbnail($post->ID);\n              if (!$already_has_thumb)  {\n              $attached_image = get_children( \"post_parent=$post->ID&post_type=attachment&post_mime_type=image&numberposts=1\" );\n                          if ($attached_image) {\n                                foreach ($attached_image as $attachment_id => $attachment) {\n                                set_post_thumbnail($post->ID, $attachment_id);\n                                }\n                           }\n                        }\n      }\nadd_action('the_post', 'autoset_featured');\nadd_action('save_post', 'autoset_featured');\nadd_action('draft_to_publish', 'autoset_featured');\nadd_action('new_to_publish', 'autoset_featured');\nadd_action('pending_to_publish', 'autoset_featured');\nadd_action('future_to_publish', 'autoset_featured');\n\n\n// MADE FOR CUSTOM POST TYPES CATEGORIES\nfunction get_the_category_bytax( $id = false, $tcat = 'category' ) {\n    $categories = get_the_terms( $id, $tcat );\n    if ( ! $categories )\n        $categories = array();\n\n    $categories = array_values( $categories );\n\n    foreach ( array_keys( $categories ) as $key ) {\n        _make_cat_compat( $categories[$key] );\n    }\n\n    // Filter name is plural because we return alot of categories (possibly more than #13237) not just one\n    return apply_filters( 'get_the_categories', $categories );\n}\n\n\n\n/////////////////////////////////////\n\n// Related Posts\n\n/////////////////////////////////////\n\nif ( !function_exists( 'getRelatedWikis' ) ) {\n\nfunction getRelatedPosts( $count=3) {\n\n    global $post;\n\n    $orig_post = $post;\n\n\n\n    $tags = wp_get_post_tags($post->ID);\n\n    if ($tags) {\n\n        $tag_ids = array();\n\n        foreach($tags as $individual_tag) $tag_ids[] = $individual_tag->term_id;\n\n        $args=array(\n\n            'tag__in' => $tag_ids,\n\n            'post__not_in' => array($post->ID),\n\n            'posts_per_page'=> $count, // Number of related posts that will be shown.\n\n            'ignore_sticky_posts'=>1\n\n        );\n\n        $my_query = new WP_Query( $args );\n\n        if( $my_query->have_posts() ) { ?>\n\n            <div id=\"related-posts\">\n\n            \t<h4 class=\"post-header\"><span class=\"post-header\"><?php _e( 'You may also like...', 'mvp-text' ); ?></span></h4>\n\n\t\t\t<ul>\n\n            \t\t<?php while( $my_query->have_posts() ) { $my_query->the_post(); ?>\n\n            \t\t\t<li>\n\n                \t\t<div class=\"related-image\">\n\n\t\t\t\t\t<?php if (  (function_exists('has_post_thumbnail')) && (has_post_thumbnail())  ) { ?>\n\n\t\t\t\t\t<a href=\"<?php the_permalink(); ?>\" rel=\"bookmark\" title=\"<?php the_title(); ?>\"><?php the_post_thumbnail('medium-thumb'); ?></a>\n\n\t\t\t\t\t<?php } ?>\n\n\t\t\t\t</div><!--related-image-->\n\n\t\t\t\t<div class=\"related-text\">\n\n\t\t\t\t\t<a href=\"<?php the_permalink() ?>\" class=\"main-headline\"><?php the_title(); ?></a>\n\n\t\t\t\t</div><!--related-text-->\n\n            \t\t\t</li>\n\n            \t\t<?php }\n\n            echo '</ul></div>';\n\n        }\n\n    }\n\n    $post = $orig_post;\n\n    wp_reset_query();\n\n}\n\n}","undoManager":{"mark":49,"position":62,"stack":[[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":21,"column":52},"end":{"row":22,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":22,"column":0},"end":{"row":23,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":23,"column":0},"end":{"row":24,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":0},"end":{"row":24,"column":68}},"text":"function get_the_category_bytax( $id = false, $tcat = 'category' ) {"},{"action":"insertText","range":{"start":{"row":24,"column":68},"end":{"row":25,"column":0}},"text":"\n"},{"action":"insertLines","range":{"start":{"row":25,"column":0},"end":{"row":37,"column":0}},"lines":["    $categories = get_the_terms( $id, $tcat );","    if ( ! $categories )","        $categories = array();","","    $categories = array_values( $categories );","","    foreach ( array_keys( $categories ) as $key ) {","        _make_cat_compat( $categories[$key] );","    }","","    // Filter name is plural because we return alot of categories (possibly more than #13237) not just one","    return apply_filters( 'get_the_categories', $categories );"]},{"action":"insertText","range":{"start":{"row":37,"column":0},"end":{"row":37,"column":1}},"text":"}"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":23,"column":0},"end":{"row":24,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":0},"end":{"row":24,"column":1}},"text":"/"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":1},"end":{"row":24,"column":2}},"text":"/"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":2},"end":{"row":24,"column":3}},"text":"/"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":3},"end":{"row":24,"column":4}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":24,"column":3},"end":{"row":24,"column":4}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":24,"column":2},"end":{"row":24,"column":3}},"text":"/"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":2},"end":{"row":24,"column":3}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":3},"end":{"row":24,"column":4}},"text":"M"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":4},"end":{"row":24,"column":5}},"text":"A"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":5},"end":{"row":24,"column":6}},"text":"D"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":6},"end":{"row":24,"column":7}},"text":"E"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":7},"end":{"row":24,"column":8}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":8},"end":{"row":24,"column":9}},"text":"F"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":9},"end":{"row":24,"column":10}},"text":"O"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":10},"end":{"row":24,"column":11}},"text":"R"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":11},"end":{"row":24,"column":12}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":12},"end":{"row":24,"column":13}},"text":"C"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":13},"end":{"row":24,"column":14}},"text":"U"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":14},"end":{"row":24,"column":15}},"text":"S"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":15},"end":{"row":24,"column":16}},"text":"T"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":16},"end":{"row":24,"column":17}},"text":"O"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":17},"end":{"row":24,"column":18}},"text":"M"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":18},"end":{"row":24,"column":19}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":19},"end":{"row":24,"column":20}},"text":"P"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":20},"end":{"row":24,"column":21}},"text":"O"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":21},"end":{"row":24,"column":22}},"text":"S"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":22},"end":{"row":24,"column":23}},"text":"T"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":23},"end":{"row":24,"column":24}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":24},"end":{"row":24,"column":25}},"text":"T"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":25},"end":{"row":24,"column":26}},"text":"Y"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":26},"end":{"row":24,"column":27}},"text":"P"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":27},"end":{"row":24,"column":28}},"text":"E"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":28},"end":{"row":24,"column":29}},"text":"S"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":29},"end":{"row":24,"column":30}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":30},"end":{"row":24,"column":31}},"text":"C"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":31},"end":{"row":24,"column":32}},"text":"A"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":32},"end":{"row":24,"column":33}},"text":"T"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":33},"end":{"row":24,"column":34}},"text":"E"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":34},"end":{"row":24,"column":35}},"text":"G"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":35},"end":{"row":24,"column":36}},"text":"O"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":36},"end":{"row":24,"column":37}},"text":"R"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":37},"end":{"row":24,"column":38}},"text":"I"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":38},"end":{"row":24,"column":39}},"text":"E"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":39},"end":{"row":24,"column":40}},"text":"S"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":2,"column":35},"end":{"row":3,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":37,"column":1},"end":{"row":38,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":38,"column":0},"end":{"row":39,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":39,"column":0},"end":{"row":40,"column":0}},"text":"\n"},{"action":"insertLines","range":{"start":{"row":40,"column":0},"end":{"row":49,"column":0}},"lines":["","/////////////////////////////////////","","// Related Posts","","/////////////////////////////////////","","",""]},{"action":"insertText","range":{"start":{"row":49,"column":0},"end":{"row":49,"column":46}},"text":"if ( !function_exists( 'getRelatedPosts' ) ) {"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":49,"column":46},"end":{"row":50,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":50,"column":0},"end":{"row":50,"column":4}},"text":"    "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":50,"column":4},"end":{"row":51,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":51,"column":0},"end":{"row":51,"column":4}},"text":"    "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":51,"column":4},"end":{"row":52,"column":0}},"text":"\n"},{"action":"insertLines","range":{"start":{"row":52,"column":0},"end":{"row":129,"column":0}},"lines":["","if ( !function_exists( 'getRelatedPosts' ) ) {","","function getRelatedPosts( $count=3) {","","    global $post;","","    $orig_post = $post;","","","","    $tags = wp_get_post_tags($post->ID);","","    if ($tags) {","","        $tag_ids = array();","","        foreach($tags as $individual_tag) $tag_ids[] = $individual_tag->term_id;","","        $args=array(","","            'tag__in' => $tag_ids,","","            'post__not_in' => array($post->ID),","","            'posts_per_page'=> $count, // Number of related posts that will be shown.","","            'ignore_sticky_posts'=>1","","        );","","        $my_query = new WP_Query( $args );","","        if( $my_query->have_posts() ) { ?>","","            <div id=\"related-posts\">","","            \t<h4 class=\"post-header\"><span class=\"post-header\"><?php _e( 'You may also like...', 'mvp-text' ); ?></span></h4>","","\t\t\t<ul>","","            \t\t<?php while( $my_query->have_posts() ) { $my_query->the_post(); ?>","","            \t\t\t<li>","","                \t\t<div class=\"related-image\">","","\t\t\t\t\t<?php if (  (function_exists('has_post_thumbnail')) && (has_post_thumbnail())  ) { ?>","","\t\t\t\t\t<a href=\"<?php the_permalink(); ?>\" rel=\"bookmark\" title=\"<?php the_title(); ?>\"><?php the_post_thumbnail('medium-thumb'); ?></a>","","\t\t\t\t\t<?php } ?>","","\t\t\t\t</div><!--related-image-->","","\t\t\t\t<div class=\"related-text\">","","\t\t\t\t\t<a href=\"<?php the_permalink() ?>\" class=\"main-headline\"><?php the_title(); ?></a>","","\t\t\t\t</div><!--related-text-->","","            \t\t\t</li>","","            \t\t<?php }","","            echo '</ul></div>';","","        }","","    }","","    $post = $orig_post;","","    wp_reset_query();","","}",""]},{"action":"insertText","range":{"start":{"row":129,"column":0},"end":{"row":129,"column":1}},"text":"}"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":51,"column":0},"end":{"row":51,"column":4}},"text":"    "},{"action":"removeLines","range":{"start":{"row":47,"column":0},"end":{"row":51,"column":0}},"nl":"\n","lines":["","","if ( !function_exists( 'getRelatedPosts' ) ) {","    "]}]}],[{"group":"doc","deltas":[{"action":"removeLines","range":{"start":{"row":47,"column":0},"end":{"row":48,"column":0}},"nl":"\n","lines":[""]}]}],[{"group":"doc","deltas":[{"action":"removeLines","range":{"start":{"row":47,"column":0},"end":{"row":48,"column":0}},"nl":"\n","lines":[""]}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":47,"column":34},"end":{"row":47,"column":38}},"text":"Post"},{"action":"insertText","range":{"start":{"row":47,"column":34},"end":{"row":47,"column":35}},"text":"W"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":47,"column":35},"end":{"row":47,"column":36}},"text":"i"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":47,"column":36},"end":{"row":47,"column":37}},"text":"k"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":47,"column":37},"end":{"row":47,"column":38}},"text":"i"}]}]]},"ace":{"folds":[],"scrolltop":480,"scrollleft":0,"selection":{"start":{"row":57,"column":12},"end":{"row":57,"column":28},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":33,"state":"php-start","mode":"ace/mode/php"}},"timestamp":1415810652872}